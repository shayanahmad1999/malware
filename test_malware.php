<?php
include 'connection.php';
$query = "SELECT * FROM `" . $table_name . "` WHERE `post_content` LIKE '%<script%'";
$fetch = $connect->query($query);

if ($fetch == false) {
    die($connect->error);
}


if ($fetch->num_rows > 0) {
    $row_count = $fetch->num_rows;
    // echo "<p>Number of rows: $row_count</p>";
    echo "<table><thead><tr><td>post_content</td></tr></thead><tbody>";
    foreach ($fetch as $value) {
        $post_content = $value['post_content'];

        $dom = new DOMDocument();
        libxml_use_internal_errors(true);
        $dom->loadHTML($post_content);
        libxml_clear_errors();

        $xpath = new DOMXPath($dom);
        $script_tags = $xpath->query('//script');

        foreach ($script_tags as $script_tag) {
            $script_html = $dom->saveHTML($script_tag);
            echo "<tr><td><br><br><br>" . htmlspecialchars($script_html) . "</td></tr>";
        }
    }
    echo "</tbody></table>";
} else {
    echo "No results found.";
}

$connect->close();
